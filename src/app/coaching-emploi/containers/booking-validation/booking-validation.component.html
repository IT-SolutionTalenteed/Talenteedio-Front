<div class="validation-container">
  <div class="content-wrapper">
    
    <!-- Error State -->
    <div *ngIf="error" class="error-card">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
      <h2>Erreur</h2>
      <p>{{ error }}</p>
      <button class="home-button" [routerLink]="['/coaching-emploi']">
        Retour à l'accueil
      </button>
    </div>

    <!-- Success State -->
    <div *ngIf="success" class="success-card">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
      </svg>
      <h2>Validation effectuée !</h2>
      <p *ngIf="action === 'confirm'">
        La réservation a été confirmée. Le client recevra un email de confirmation avec les détails du rendez-vous.
      </p>
      <p *ngIf="action === 'reject'">
        La réservation a été refusée. Le client sera remboursé et recevra un email d'information.
      </p>
      <div class="redirect-info">
        <p>Redirection automatique dans quelques secondes...</p>
      </div>
    </div>

    <!-- Validation Form -->
    <div *ngIf="!error && !success" class="validation-card">
      <div class="booking-info">
        <h1 class="page-title">Validation de réservation</h1>
        <p class="booking-id">Réservation #{{ bookingId }}</p>
        
        <!-- Détails de la réservation -->
        <div *ngIf="bookingDetails" class="booking-details">
          <div class="detail-row">
            <span class="label">Client :</span>
            <span class="value">{{ bookingDetails.clientName }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Service :</span>
            <span class="value">{{ bookingDetails.serviceTitle }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Date :</span>
            <span class="value">{{ bookingDetails.bookingDate | date:'fullDate':'':'fr' }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Heure :</span>
            <span class="value">{{ bookingDetails.bookingTime }} ({{ bookingDetails.timezone }})</span>
          </div>
          <div class="detail-row">
            <span class="label">Montant :</span>
            <span class="value">{{ bookingDetails.amount }}€</span>
          </div>
        </div>
      </div>

      <div class="action-section" [class]="actionClass">
        <div class="action-icon">
          <svg *ngIf="action === 'confirm'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
          </svg>
          <svg *ngIf="action === 'reject'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </div>
        
        <h2>{{ actionText }} la réservation</h2>
        
        <div class="action-description">
          <p *ngIf="action === 'confirm'">
            En confirmant cette réservation, vous vous engagez à honorer le rendez-vous aux date et heure convenues. 
            Le client recevra un email de confirmation avec vos coordonnées.
          </p>
          <p *ngIf="action === 'reject'">
            En refusant cette réservation, le client sera automatiquement remboursé intégralement. 
            Veuillez indiquer la raison du refus pour informer le client.
          </p>
        </div>
      </div>

      <form (ngSubmit)="validateBooking()" class="validation-form">
        <div class="form-field">
          <label for="message">
            {{ action === 'confirm' ? 'Message de confirmation (optionnel)' : 'Raison du refus *' }}
          </label>
          <textarea
            id="message"
            [(ngModel)]="consultantMessage"
            name="message"
            [required]="action === 'reject'"
            [placeholder]="action === 'confirm' 
              ? 'Ajoutez un message personnalisé pour le client...' 
              : 'Expliquez pourquoi vous ne pouvez pas honorer cette réservation...'"
            rows="4"
          ></textarea>
        </div>

        <div class="form-actions">
          <button 
            type="button" 
            class="cancel-button" 
            [routerLink]="['/coaching-emploi']"
          >
            Annuler
          </button>
          
          <button 
            type="submit" 
            class="validate-button" 
            [class]="actionClass"
            [disabled]="loading || (action === 'reject' && !consultantMessage.trim())"
          >
            <span *ngIf="!loading">{{ actionText }}</span>
            <span *ngIf="loading" class="loading-spinner"></span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>