<div class="header-container">
  <!-- Desktop Header -->
  <header class="desktop-header">
    <div class="header-content">
      <!-- Logo -->
      <div class="logo-section">
        <a routerLink="/home" class="logo-link">
          <img
            [src]="'assets/img/talenteed-noir-plan-de-travail-1-150.png'"
            alt="Talenteed.io"
            class="logo-image"
          />
        </a>
        <span class="logo-tagline">The alternative media for HR</span>
      </div>

      <!-- Navigation Menu -->
      <nav class="main-navigation">
        <ul class="nav-list">
          <li
            *ngFor="let menu of navbarMenus"
            class="nav-item"
            [class.has-mega-menu]="menu.megaMenu"
          >
            <a
              [routerLink]="menu.megaMenu ? null : menu.routerLink"
              class="nav-link"
              [class.active]="currentUrl.includes(menu.parentRouterLink)"
              (mouseenter)="onMenuHover(menu)"
            >
              {{ menu.title }}
            </a>

            <!-- Mega Menu Dropdown -->
            <div
              *ngIf="menu.megaMenu && hoveredMenu === menu"
              class="mega-menu-dropdown"
              @fadeInOut
              (mouseenter)="onMenuHover(menu)"
              (mouseleave)="onMenuLeave()"
            >
              <div class="mega-menu-content">
                <div class="mega-menu-layout">
                  <!-- Left Column - Hero Message -->
                  <div class="mega-menu-hero">
                    <h3 class="mega-menu-hero-title">
                      Ouvrez-vous Ã  un nouveau monde de possibilitÃ©s
                    </h3>
                    <p class="mega-menu-hero-subtitle">
                      DÃ©couvrez les meilleures opportunitÃ©s
                    </p>
                  </div>

                  <!-- Right Column - Links -->
                  <div class="mega-menu-links">
                    <a
                      *ngFor="let subMenu of menu.subMenus"
                      [routerLink]="subMenu.routerLink"
                      class="mega-menu-link-item"
                      (click)="onMenuLeave()"
                    >
                      <div class="mega-menu-link-content">
                        <h4 class="mega-menu-link-title">{{ subMenu.title }}</h4>
                        <p *ngIf="subMenu.description" class="mega-menu-link-description">
                          {{ subMenu.description }}
                        </p>
                      </div>
                      <svg class="mega-menu-arrow" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </li>
        </ul>
      </nav>

      <!-- Right Section -->
      <div class="header-actions">
        <!-- Favorites Menu (Logged In) -->
        <app-favorite-menu *ngIf="user"></app-favorite-menu>

        <!-- Language Selector -->
        <div class="language-dropdown" (click)="toggleLanguageDropdown()">
          <button class="language-button">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V6H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z" fill="currentColor"/>
            </svg>
            <span class="language-label">{{ currentLanguage === 'fr' ? 'FranÃ§ais' : 'English' }}</span>
            <svg class="dropdown-icon" width="12" height="8" viewBox="0 0 12 8">
              <path
                d="M1 1.5L6 6.5L11 1.5"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>

          <!-- Language Dropdown -->
          <div class="language-dropdown-menu" [class.show]="showLanguageDropdown">
            <button
              class="language-option"
              [class.active]="currentLanguage === 'fr'"
              (click)="changeLanguage('fr')"
            >
              <span class="language-flag">ðŸ‡«ðŸ‡·</span>
              <span class="language-name">FranÃ§ais</span>
              <svg *ngIf="currentLanguage === 'fr'" class="check-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button
              class="language-option"
              [class.active]="currentLanguage === 'en'"
              (click)="changeLanguage('en')"
            >
              <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
              <span class="language-name">English</span>
              <svg *ngIf="currentLanguage === 'en'" class="check-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Auth Buttons (Not Logged In) -->
        <div *ngIf="!user" class="auth-buttons">
          <a
            [routerLink]="['/authentication/sign-up-choice']"
            class="btn btn-outline"
          >
            Inscription
          </a>
          <a
            [routerLink]="['/authentication/sign-in']"
            [queryParams]="{ redirect: currentUrl }"
            class="btn btn-primary"
          >
            Connexion
          </a>
        </div>

        <!-- User Menu (Logged In) -->
        <div *ngIf="user" class="user-menu" (click)="toggleUserDropdown()">
          <button class="user-button">
            <img
              *ngIf="user?.profilePicture?.fileUrl"
              [src]="user.profilePicture.fileUrl"
              alt="Profile"
              class="user-avatar"
            />
            <div *ngIf="!user?.profilePicture?.fileUrl" class="user-avatar-placeholder">
              <fa-icon [icon]="icon"></fa-icon>
            </div>
            <span class="user-name">
              {{
                user.lastname
                  ? user.lastname
                  : user.firstname
                  ? user.firstname
                  : user.email
              }}
            </span>
            <svg class="dropdown-icon" width="12" height="8" viewBox="0 0 12 8">
              <path
                d="M1 1.5L6 6.5L11 1.5"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>

          <!-- User Dropdown -->
          <div class="user-dropdown" [class.show]="showUserDropdown">
            <a
              *ngFor="let menu of menusCopy"
              [routerLink]="menu.title === 'Dashboard' ? null : [menu.routerLink]"
              (click)="menu.title === 'Dashboard' ? goToDashboard($event) : null"
              class="dropdown-item"
            >
              {{ menu.title }}
            </a>
            <div class="dropdown-divider"></div>
            <a (click)="logout()" class="dropdown-item logout">
              <i class="fas fa-sign-out-alt"></i>
              DÃ©connexion
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Header -->
  <header class="mobile-header">
    <div class="mobile-header-content">
      <!-- Logo -->
      <a routerLink="/home" class="mobile-logo">
        <img
          [src]="'assets/img/talenteed-noir-plan-de-travail-1-150.png'"
          alt="Talenteed.io"
        />
      </a>

      <!-- Mobile Actions -->
      <div class="mobile-actions">
        <!-- Favorites Menu (Mobile) -->
        <app-favorite-menu *ngIf="user" class="mobile-favorite-menu"></app-favorite-menu>

        <!-- Language Selector Mobile -->
        <div class="mobile-language-selector" (click)="toggleLanguageDropdown()">
          <button class="mobile-language-button">
            <span class="mobile-language-flag">{{ currentLanguage === 'fr' ? 'ðŸ‡«ðŸ‡·' : 'ðŸ‡¬ðŸ‡§' }}</span>
          </button>
          
          <!-- Mobile Language Dropdown -->
          <div class="mobile-language-dropdown" [class.show]="showLanguageDropdown">
            <button
              class="mobile-language-option"
              [class.active]="currentLanguage === 'fr'"
              (click)="changeLanguage('fr')"
            >
              <span class="language-flag">ðŸ‡«ðŸ‡·</span>
              <span>FR</span>
            </button>
            <button
              class="mobile-language-option"
              [class.active]="currentLanguage === 'en'"
              (click)="changeLanguage('en')"
            >
              <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
              <span>EN</span>
            </button>
          </div>
        </div>

        <!-- User Avatar -->
        <button *ngIf="user" class="mobile-user-btn" (click)="toggleUserDropdown()">
          <img
            *ngIf="user?.profilePicture?.fileUrl"
            [src]="user.profilePicture.fileUrl"
            alt="Profile"
            class="mobile-avatar"
          />
          <div *ngIf="!user?.profilePicture?.fileUrl" class="mobile-avatar-placeholder">
            <fa-icon [icon]="icon"></fa-icon>
          </div>
        </button>

        <!-- Hamburger Menu -->
        <button
          class="mobile-menu-toggle"
          [class.active]="isShowingMobileNav"
          (click)="onToggleNavbar()"
        >
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav" [class.active]="isShowingMobileNav">
      <div class="mobile-nav-content">
        <ul class="mobile-nav-list">
          <li *ngFor="let menu of navbarMenus" class="mobile-nav-item">
            <!-- Menu without submenu -->
            <a
              *ngIf="!menu.megaMenu"
              [routerLink]="menu.routerLink"
              class="mobile-nav-link"
              (click)="onToggleNavbar()"
            >
              {{ menu.title }}
            </a>

            <!-- Menu with submenu -->
            <div *ngIf="menu.megaMenu" class="mobile-nav-group">
              <button
                class="mobile-nav-link with-submenu"
                (click)="toggleMobileSubmenu(menu)"
                [class.active]="activeMobileSubmenu === menu"
              >
                {{ menu.title }}
                <svg class="mobile-dropdown-icon" width="12" height="8" viewBox="0 0 12 8">
                  <path
                    d="M1 1.5L6 6.5L11 1.5"
                    stroke="currentColor"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
              <ul
                class="mobile-submenu"
                [class.show]="activeMobileSubmenu === menu"
              >
                <li *ngFor="let subMenu of menu.subMenus">
                  <a
                    [routerLink]="subMenu.routerLink"
                    class="mobile-submenu-link"
                    (click)="onToggleNavbar()"
                  >
                    <i [class]="'fas fa-' + subMenu.icon"></i>
                    {{ subMenu.title }}
                  </a>
                </li>
              </ul>
            </div>
          </li>
        </ul>

        <!-- Mobile Auth Buttons -->
        <div *ngIf="!user" class="mobile-auth-buttons">
          <a
            [routerLink]="['/authentication/sign-up-choice']"
            class="mobile-btn mobile-btn-outline"
            (click)="onToggleNavbar()"
          >
            Inscription
          </a>
          <a
            [routerLink]="['/authentication/sign-in']"
            [queryParams]="{ redirect: currentUrl }"
            class="mobile-btn mobile-btn-primary"
            (click)="onToggleNavbar()"
          >
            Connexion
          </a>
        </div>

        <!-- Mobile User Menu -->
        <div *ngIf="user" class="mobile-user-menu">
          <div class="mobile-user-info">
            <img
              *ngIf="user?.profilePicture?.fileUrl"
              [src]="user.profilePicture.fileUrl"
              alt="Profile"
              class="mobile-user-avatar"
            />
            <div *ngIf="!user?.profilePicture?.fileUrl" class="mobile-user-avatar-placeholder">
              <fa-icon [icon]="icon"></fa-icon>
            </div>
            <span class="mobile-user-name">
              {{ user.firstname }} {{ user.lastname }}
            </span>
          </div>
          <div class="mobile-user-links">
            <a
              *ngFor="let menu of menusCopy"
              [routerLink]="menu.title === 'Dashboard' ? null : [menu.routerLink]"
              (click)="menu.title === 'Dashboard' ? goToDashboard($event) : onToggleNavbar()"
              class="mobile-user-link"
            >
              {{ menu.title }}
            </a>
            <a (click)="logout()" class="mobile-user-link logout">
              <i class="fas fa-sign-out-alt"></i>
              DÃ©connexion
            </a>
          </div>
        </div>
      </div>
    </nav>
  </header>
</div>
